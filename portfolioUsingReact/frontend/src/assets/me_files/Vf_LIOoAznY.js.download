;/*FB_PKG_DELIM*/

__d("LSVec",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a.slice(0);a.tag="ls-array";return a}function b(a){return a}c={make:a,toArray:b};f["default"]=c}),66);
__d("XPolarisFacebookSyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/sync/instagram/",{})}),null);
__d("PolarisFacebookToInstagramCookieSync.react",["FBLogger","PolarisDOMListener.react","PolarisFacebookCookieSyncConstants","PolarisODS","XAsyncRequest","XPolarisFacebookSyncController","buildIframeOriginUrl","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("buildIframeOriginUrl")("https://www.facebook.com");function a(a){var b=a.frameRef;if(!c("gkx")("6534"))return null;a=function(a){if(a.origin!==i)return;var b=a.data.eventName;switch(b){case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ready:e();break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync_success:c("PolarisODS").incr("web.cookie_sync.oo_cookie.retrieve_success");b=c("XPolarisFacebookSyncController").getURIBuilder().getURI();new(c("XAsyncRequest"))().setURI(b).setMethod("POST").setData({encrypted_data:(b=a.data.data)==null?void 0:b.data}).setHandler(function(a){c("PolarisODS").incr("web.cookie_sync.oo_cookie.sync_success")}).setErrorHandler(function(a){c("PolarisODS").incr("web.cookie_sync.oo_cookie.sync_fail");a=(a=a.errorDescription)!=null?a:"Error when syncing ig cookies";c("FBLogger")("ig_web").mustfix(a)}).send();break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync_error:c("PolarisODS").incr("web.cookie_sync.oo_cookie.retrieve_error");a=(b=a.data.errorDescription)!=null?b:"Exception thrown when syncing cookie to sync ig cookie";c("FBLogger")("ig_web").mustfix(a)}};var e=function(){c("PolarisODS").incr("web.cookie_sync.oo_cookie.start_fb_sync");var a=b.current;a==null?void 0:(a=a.contentWindow)==null?void 0:a.postMessage({eventName:d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync},i)};return h.jsx(c("PolarisDOMListener.react"),{event:"message",handler:a,target:window})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PolarisInstagramToFacebookCookieSync.react",["FBLogger","PolarisAPIGetFrCookie","PolarisDOMListener.react","PolarisFacebookCookieSyncConstants","PolarisIgFrCookieUpdaterFalcoEvent","PolarisODS","PolarisReactRedux","PolarisWebStorage","PolarisuserSelectors","browserHistory","buildIframeOriginUrl","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useRef,j=c("buildIframeOriginUrl")("https://www.facebook.com"),k="fr",l=Number(new Date().getTime());function m(a){a.total_latency=new Date().getTime()-l,d("PolarisIgFrCookieUpdaterFalcoEvent").IgFrCookieUpdaterFalcoEvent.log(function(){return a})}function a(a){var b=a.frData,e=a.frameRef;a=Number(d("PolarisReactRedux").useSelector(function(a){return(a=d("PolarisuserSelectors").getViewer(a))==null?void 0:a.id}));var f=d("browserHistory").getPath(d("browserHistory").browserHistory);a=i({ig_user_id:a,iframe_origin:j,is_blacklisted:!1,local_storage_same_as_api:!0,show_iframe:!1,local_storage_updated:!1,is_control_group:!1,is_local_storage_accessible:!1,browser_history_path:f,local_storage_data:b});var g=a.current;if(!c("gkx")("4906")){g.is_blacklisted=!0;m(g);return null}f=function(a){var b=a.data.eventName;g.iframe_message_origin=a.origin;if(a.origin!==j){b in d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES&&(g.iframe_message_origin_mismatch=!0,m(g));return}switch(b){case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ready:c("PolarisODS").incr("web.frcookie.iframe.ready");g.iframe_message_ready=!0;l();break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.success:c("PolarisODS").incr("web.frcookie.iframe.success");g.iframe_message_success=!0;m(g);break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.error:c("PolarisODS").incr("web.frcookie.iframe.error");n();g.iframe_message_error=!0;m(g);break}};var l=function(){g.iframe_non_null=!1;g.iframe_content_window_non_null=!1;var a=e.current;if(a==null)return;b==null&&c("PolarisODS").incr("web.frcookie.local_storage.empty");d("PolarisAPIGetFrCookie").getFrCookie(b).then(function(e){g.api_data=e.fr;if(e.fr===b){m(g);return}g.local_storage_same_as_api=!1;var f=c("PolarisWebStorage").getLocalStorage();if(f==null){m(g);return}g.is_local_storage_accessible=!0;if(e.fr===""){f.removeItem(k);c("PolarisODS").incr("web.frcookie.local_storage.remove");m(g);return}f.setItem(k,e.fr);g.show_iframe=!0;g.local_storage_updated=!0;g.iframe_payload=e.fr;g.iframe_non_null=!0;a.contentWindow!=null&&(g.iframe_content_window_non_null=!0,a.contentWindow.postMessage({data:e.fr,eventName:d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.sync},j));c("PolarisODS").incr("web.frcookie.local_storage.update")})["catch"](function(a){g.exception=a.toString(),m(g),c("FBLogger")("ig_web").catching(a).mustfix("Exception thrown when getting frCookie")})},n=function(){var a=c("PolarisWebStorage").getLocalStorage();c("PolarisWebStorage").isLocalStorageSupported()&&a!=null&&a.removeItem(k)};return h.jsx(c("PolarisDOMListener.react"),{event:"message",handler:f,target:window})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PolarisFacebookCookieSyncImpl.react",["JSScheduler","PolarisDOMListener.react","PolarisFacebookToInstagramCookieSync.react","PolarisIgFrCookieUpdaterFalcoEvent","PolarisInstagramToFacebookCookieSync.react","PolarisReactRedux","PolarisUA","PolarisWebStorage","PolarisuserSelectors","RunComet","browserHistory","buildIframeOriginUrl","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useEffect,j=b.useRef,k=b.useState,l=c("buildIframeOriginUrl")("https://www.facebook.com"),m=l+"/instagram/login_sync/",n="fr",o=["terms","challenge"],p=Number(new Date().getTime());function q(a){a.total_latency=new Date().getTime()-p,d("PolarisIgFrCookieUpdaterFalcoEvent").IgFrCookieUpdaterFalcoEvent.log(function(){return a})}var r=function(){if(!d("PolarisUA").isIGWebview()&&!d("PolarisUA").isIgLite()&&c("PolarisWebStorage").isLocalStorageSupported()){var a=c("PolarisWebStorage").getLocalStorage();if(a!=null)return a.getItem(n)}return null};function s(a){a=a.frData;var b=j(null),e=Number(d("PolarisReactRedux").useSelector(function(a){return(a=d("PolarisuserSelectors").getViewer(a))==null?void 0:a.id}));e=j({ig_user_id:e,iframe_origin:l,is_blacklisted:!1,local_storage_same_as_api:!0,show_iframe:!1,local_storage_updated:!1,is_control_group:!1,is_local_storage_accessible:!1,browser_history_path:d("browserHistory").getPath(d("browserHistory").browserHistory),local_storage_data:a});var f=e.current;e=function(){f.iframe_unload=!0};var g=k(!1),n=g[0],o=g[1];i(function(){var a=null,b=d("RunComet").onAfterLoad(function(){a=c("JSScheduler").scheduleLoggingPriCallback(function(){return o(!0)})});return function(){a&&c("JSScheduler").cancelCallback(a),b&&b.remove()}},[]);return!n?null:h.jsxs(h.Fragment,{children:[h.jsx("iframe",{onError:function(){f.iframe_on_error=!0,q(f)},onLoad:function(){f.iframe_on_load=!0},ref:b,src:m,style:{height:0,width:0,border:"none",display:"none"},title:"fr"}),h.jsx(c("PolarisInstagramToFacebookCookieSync.react"),{frameRef:b,frData:a}),h.jsx(c("PolarisFacebookToInstagramCookieSync.react"),{frameRef:b}),h.jsx(c("PolarisDOMListener.react"),{event:"beforeunload",handler:e,target:window})]})}s.displayName=s.name+" [from "+f.id+"]";function a(){var a=d("PolarisReactRedux").useSelector(function(a){return!!(a==null?void 0:(a=a.cookieModal)==null?void 0:a.visible)}),b=Number(d("PolarisReactRedux").useSelector(function(a){return(a=d("PolarisuserSelectors").getViewer(a))==null?void 0:a.id}));if(a)return null;var c=d("browserHistory").getPath(d("browserHistory").browserHistory);if(o.some(function(a){return c.includes(a)})){q({ig_user_id:b,iframe_origin:l,is_blacklisted:!0,local_storage_same_as_api:!0,show_iframe:!1,local_storage_updated:!1,is_control_group:!1,browser_history_path:c,is_local_storage_accessible:!1});return null}return h.jsx(s,{frData:r()})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);